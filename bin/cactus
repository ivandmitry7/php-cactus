#!/usr/bin/env php

<?php

include $_composer_autoload_path;

if (!in_array("noPrompt", $argv, true)) {
    $shouldContinue = readline('Are you sure you want to proceed to compilation? (Y/N): ');
    if (strtolower($shouldContinue) !== 'y') {
        exit(0);
    }
}

try {
    $cactus = new \Notihnio\Cactus\Cactus();
} catch (\Notihnio\Cactus\Exception\DepedencyException $exception) {
    echo "Dependency error: {$exception->getMessage()}\n";
    exit(1);
}

$rootDir = dirname(__FILE__, 5);

try {
    $cactus->compile($rootDir);
} catch (\Notihnio\Cactus\Exception\RunTimeException $exception) {
    echo "Runtime error: {$exception->getMessage()}\n";
    exit(1);
}
